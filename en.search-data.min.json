[{"id":0,"href":"/errors/","title":"Errors","parent":"Step by Step Dev","content":""},{"id":1,"href":"/errors/prosody/","title":"Prosody","parent":"Errors","content":"Traceback[Bosh]: Attempt to perform arithmetic on a table value    When I start a meeting I get the following output in the prosody logs:\nJul 26 04:17:12 mod_bosh info New BOSH session, assigned it sid \u0026#39;b0be5f11-8434-4b1d-b707-14a6a703df14\u0026#39; Jul 26 04:17:12 boshb0be5f11-8434-4b1d-b707-14a6a703df14 info Authenticated as df6d8268-d64a-4d0d-855f-e2c20b40c32f@freemeet.net Jul 26 04:17:12 mod_bosh error Traceback[bosh]: ...jitsi-meet/prosody-plugins/mod_external_services.lua:119: attempt to perform arithmetic on a table value stack traceback: ...jitsi-meet/prosody-plugins/mod_external_services.lua:119: in function \u0026#39;get_services\u0026#39; ...jitsi-meet/prosody-plugins/mod_external_services.lua:169: in function \u0026#39;?\u0026#39; /usr/lib/prosody/util/events.lua:78: in function \u0026lt;/usr/lib/prosody/util/events.lua:74\u0026gt; (tail call): ? (tail call): ? (tail call): ? /usr/lib/prosody/util/events.lua:78: in function \u0026lt;/usr/lib/prosody/util/events.lua:74\u0026gt; (tail call): ? /usr/lib/prosody/core/stanza_router.lua:189: in function \u0026#39;core_post_stanza\u0026#39; /usr/lib/prosody/core/stanza_router.lua:137: in function \u0026lt;/usr/lib/prosody/core/stanza_router.lua:63\u0026gt; ... /usr/lib/prosody/net/http/server.lua:112: in function \u0026#39;process_next\u0026#39; /usr/lib/prosody/net/http/server.lua:128: in function \u0026#39;success_cb\u0026#39; /usr/lib/prosody/net/http/parser.lua:177: in function \u0026#39;feed\u0026#39; /usr/lib/prosody/net/http/server.lua:159: in function \u0026lt;/usr/lib/prosody/net/http/server.lua:158\u0026gt; (tail call): ? /usr/lib/prosody/net/server_select.lua:879: in function \u0026lt;/usr/lib/prosody/net/server_select.lua:861\u0026gt; [C]: in function \u0026#39;xpcall\u0026#39; /usr/bin/prosody:400: in function \u0026#39;loop\u0026#39; /usr/bin/prosody:431: in main chunk [C]: ?  Attempt 1 ↕  Monday July 26, 2021\nPotential fix\n Change all \u0026ldquo;none\u0026rdquo; to \u0026ldquo;null\u0026rdquo; in prosody config file  This did not fix the problem, however, this did not introduce any new errors either\n  "},{"id":2,"href":"/","title":"Step by Step Dev","parent":"","content":""},{"id":3,"href":"/ubuntu18/jitsi/logging/","title":"Logging","parent":"Jitsi","content":"Start, Stop, Restart Jitsi Components    # Status $ systemctl status nginx prosody jitsi-videobridge2 jicofo jigasi # Stop $ systemctl stop nginx prosody jitsi-videobridge2 jicofo jigasi # Clear all logs $ rm /var/log/jitsi/*.log # Start in this order $ systemctl start nginx $ systemctl start prosody $ systemctl start jitsi-videobridge2 $ systemctl start jicofo $ systemctl start jigasi # Restart in this order $ systemctl restart nginx $ systemctl restart prosody $ systemctl restart jitsi-videobridge2 $ systemctl restart jicofo $ systemctl restart jigasi Logs \u0026amp; Settings    All Logs    $ tail -f /var/log/jitsi/*.log Jigasi    Logs\n# Systemd Logs $ egrep --color \u0026#39;jigasi\u0026#39; /var/log/syslog # Monitor Jigasi Logs $ tail -f /var/log/jitsi/jigasi.log # Filter jigasi logs $ tail -f /var/log/jitsi/jigasi.log | grep SEVERE $ tail -f /var/log/jitsi/jigasi.log | egrep -i --color -A 5 \u0026#39;severe|vosk\u0026#39; $ egrep -i --color \u0026#39;warn|severe|vosk\u0026#39; /var/log/jitsi/jigasi.log $ egrep -i --color -A 5 \u0026#39;severe|vosk\u0026#39; /var/log/jitsi/jigasi.log Settings\n# Properties $ vim /etc/jitsi/jigasi/sip-communicator.properties # In case of file error $ rm /etc/jitsi/jigasi/.sip-communicator.properties.swp # Config JAVA_SYS_PROPS=\u0026#34;-Djava.util.logging.config.file=/etc/jitsi/jigasi/logging.properties\u0026#34; Vosk    # Check logs $ tail -f /var/log/syslog $ tail -f /var/log/syslog | egrep --color \u0026#39;python3\u0026#39; $ grep \u0026#39;Vosk Service\u0026#39; /var/log/syslog $ grep \u0026#39;python\u0026#39; /var/log/syslog JVB    Logs\nSettings\n# Properties $ vim /etc/jitsi/videobridge/sip-communicator.properties # In case of file error $ rm /etc/jitsi/videobridge/.sip-communicator.properties.swp Jicofo    Logs\n# Systemd Logs $ egrep --color \u0026#39;jicofo\u0026#39; /var/log/syslog # Monitor Jigasi Logs $ tail -f /var/log/jitsi/jicofo.log # Filter jigasi logs $ tail -f /var/log/jitsi/jicofo.log | grep SEVERE $ tail -f /var/log/jitsi/jicofo.log | egrep -i --color -A 5 \u0026#39;severe|vosk\u0026#39; $ egrep -i --color \u0026#39;warn|severe|vosk\u0026#39; /var/log/jitsi/jicofo.log $ egrep -i --color -A 5 \u0026#39;severe|vosk\u0026#39; /var/log/jitsi/jicofo.log Settings\nProsody    Logs\n$ tail -f /var/log/prosody/prosody.log Settings\n$ vim /etc/prosody/conf.d/freemeet.net.cfg.lua "},{"id":4,"href":"/ubuntu18/","title":"Ubuntu18","parent":"Step by Step Dev","content":""},{"id":5,"href":"/ubuntu18/vosk/python/","title":"General Python Setup","parent":"Vosk","content":"Install Python 3.8\nWhat version of Python can I use? ↕  For Vosk, nshmyrev on GitHub recommends Python 3.8   Follow the article step by step: How to install Python 3.8 on Ubuntu 18.04 (Linuxize)\nTo set Python 3.8.11 as the default simply add the following to the end of your Shell profile\n$ vim ~/.bashrc # ~/.bashrc alias python3=\u0026#34;python3.8\u0026#34; $ source ~/.bashrc # Test $ python3 -V \u0026gt;\u0026gt;\u0026gt; Python 3.8.11 Python Venv Setup\nCreate a virtual environment:\n# Use Python 3.8.11 $ sudo apt install python3.8-venv $ python3 -m venv venv $ source venv/bin/activate # You shell prompt should look like this now: (venv) user@hostname:~$ "},{"id":6,"href":"/ubuntu18/vosk/vosk/","title":"Vosk Setup","parent":"Vosk","content":"Set up Vosk as a system daemon    Git \u0026amp; Vosk Server files\n$ cd $HOME $ git clone https://github.com/alphacep/vosk-server.git Install dependencies\n$ python3 -m pip install aiortc aiohttp aiorpc vosk $ python3 -m pip install websockets Download Speech Recognition model:\nModels can be found here: VOSK Models (alphacephei.com)\n# /home/$USER $ wget http://alphacephei.com/vosk/models/vosk-model-small-en-us-0.15.zip # $ sudo apt-get install unzip $ unzip vosk-model-small-en-us-0.15.zip # Rename the downloaded model for Vosk API to work $ mv vosk-model-small-en-us-0.15 model Create .service File\n$ mkdir -p ~/.config/systemd/user $ touch ~/.config/systemd/user/vosk_service.service # Check $ systemctl --user list-unit-files | grep vosk_service \u0026gt;\u0026gt;\u0026gt; vosk_service.service masked Write to .service File\nOpen .service file with your text editor,\n# Open service file $ vim ~/.config/systemd/user/vosk_service.service then paste the following text. Make sure to replace kapp with your username instead. If you are unsure about your username, type $ echo $USER into your shell.\n# systemd unit file for the Vosk Service [Unit] # Human readable name of the unit Description=Vosk Service [Service] # Command to execute when the service is started WorkingDirectory=/home/kapp ExecStart=/home/kapp/venv/bin/python3 /home/kapp/vosk-server/websocket/asr_server.py # Disable Python\u0026#39;s buffering of STDOUT and STDERR, so that output from the # service shows up immediately in systemd\u0026#39;s logs Environment=PYTHONUNBUFFERED=1 # Automatically restart the service if it crashes Restart=on-failure # Our service will notify systemd once it is up and running Type=simple # Use a dedicated user to run our service (only for system services) # User=python_demo_service [Install] # Tell systemd to automatically start this service when the system boots # (assuming the service is enabled) WantedBy=default.target Activate service\n$ systemctl --user daemon-reload $ systemctl --user status vosk_service # Press \u0026#39;q\u0026#39; (for quit) to see your shell prompt again $ systemctl --user start vosk_service $ systemctl --user status vosk_service \u0026gt;\u0026gt;\u0026gt; # Vosk Service should be green and running now! # To exit status log, press \u0026#39;q\u0026#39; (for quit) on your keyboard # Check logs $ sudo -s $ grep \u0026#39;Vosk Service\u0026#39; /var/log/syslog $ grep \u0026#39;python\u0026#39; /var/log/syslog $ exit Enable Vosk to start on boot up:\n$ systemctl --user enable vosk_service Configure Vosk for Jitsi    Jitsi uses port 10000 for audio and video communication, so we\u0026rsquo;ll change the Vosk listening port as suggested by one of the main developers of vosk\n# Stop vosk daemon $ systemctl --user stop vosk_service $ systemctl --user status vosk_service Create environment variable\n$ sudo -s $ vim /etc/environment # append to /etc/environment VOSK_SERVER_PORT=10000 You may need to open a new shell. Next, make sure the environment variable was set correctly\n# test $ printenv VOSK_SERVER_PORT \u0026gt;\u0026gt;\u0026gt; 10000 # alternative test $ python3 \u0026gt;\u0026gt;\u0026gt; import os \u0026gt;\u0026gt;\u0026gt; os.environ.get(\u0026#39;VOSK_SERVER_PORT\u0026#39;, 2700) \u0026#39;10000\u0026#39; Start the Vosk service again:\n$ systemctl --user daemon-reload $ systemctl --user start vosk_service $ systemctl --user status vosk_service Other Things    Watch Vosk logs\n$ tail -f /var/log/syslog Further Reading     For more info on python daemons see https://github.com/torfsen/python-systemd-tutorial For more on Vosk server see https://github.com/alphacep/vosk-server  "},{"id":7,"href":"/debian10/jitsi/","title":"Jitsi","parent":"Debian10","content":""},{"id":8,"href":"/debian10/vm/","title":"Vm","parent":"Debian10","content":""},{"id":9,"href":"/debian10/vosk/","title":"Vosk","parent":"Debian10","content":""},{"id":10,"href":"/Misc/","title":"Misc","parent":"Step by Step Dev","content":""},{"id":11,"href":"/ubuntu18/jitsi/","title":"Jitsi","parent":"Ubuntu18","content":""},{"id":12,"href":"/ubuntu18/virtualbox/","title":"Virtualbox","parent":"Ubuntu18","content":""},{"id":13,"href":"/ubuntu18/vosk/","title":"Vosk","parent":"Ubuntu18","content":""},{"id":14,"href":"/categories/","title":"Categories","parent":"Step by Step Dev","content":""},{"id":15,"href":"/debian10/","title":"Debian10","parent":"Step by Step Dev","content":""},{"id":16,"href":"/tags/","title":"Tags","parent":"Step by Step Dev","content":""}]